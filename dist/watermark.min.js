!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.WaterMark=e():t.WaterMark=e()}(self,(()=>(()=>{var t={938:(t,e)=>{e.defaultOpt={boxId:"wm_container_id",content:"",x:0,y:0,xSpace:0,ySpace:0,fontColor:"#000000",fontAlpha:.1,fontSize:"12px",fontFamily:"Microsoft Yahei",rotateAngle:20,bgAlpha:.1,position:"absolute",zIndex:100,textAlign:"center",monitor:!0,containerNode:null,coverAreaId:null,onLoad:!0,onResize:!0}},305:(t,e,o)=>{var n=o(72).Canvas,r=o(425).ShadowRoot;function i(t){if(!(this instanceof i))return new i(t);this.type=2,this.init(t),this._opts=t}i.prototype.init=function(t){this.shadowRoot=this.getShadowRoot(t,t.containerBox)},i.prototype.render=function(t){var e=this._opts;(1===this.type?new n:new r).create(this.shadowRoot,e,t)},i.prototype.getShadowRoot=function(t,e){var o=document.getElementById(t.boxId),n=o;if(o)o.shadowRoot&&(n=o.shadowRoot);else{(o=document.createElement("div")).id=t.boxId,o.setAttribute("style","pointer-events: none !important; display: block !important"),o.style.position="absolute",o.style.zIndex=1e4,o.style.top=0,o.style.left=0,o.style.minWidth="100%",o.style.minHeight="100%",n=2===this.type?o.attachShadow({mode:"open"}):o;var r=e.children,i=Math.floor(Math.random()*(r.length-1));r[i]?e.insertBefore(o,r[i]):e.appendChild(o)}return n},e.Adapter=i},72:(t,e)=>{function o(t){if(!(this instanceof o))return new o(t)}o.prototype.create=function(t,e,o){var n=this.createCanvas(e,o),r=document.createElement("div"),i=n.toDataURL(),a="\n    position:absolute;\n    top:0;\n    left:0;\n    bottom:0;\n    right:0;\n    width:100%;\n    height:100%;\n    pointer-events:none;\n    background-repeat:repeat;\n    background-image:url('".concat(i,"')");r.setAttribute("style",a),t.appendChild(r)},o.prototype.createCanvas=function(t,e){var o=document.createElement("canvas"),n=Math.max(t.boxWidth,t.boxHeight);o.setAttribute("width",n),o.setAttribute("height",n);var r=o.getContext("2d");return r.textAlign=e.textAlign,r.textBaseline=t.boxHeight,r.font=e.fontSize+""+e.fontFamily,r.fillStyle="rgba(184, 184, 184, ".concat(e.fontAlpha,")"),r.rotate(e.rotateAngle),r.fillText(e.content,parseFloat(t.boxWidth)/2,parseFloat(t.boxHeight)/2),o},o.prototype.calaCtxData=function(t,e,o){var n,r;switch(t=t.data,e=e.data,o){case"R":n=0,r=3;break;case"G":n=1,r=2;break;case"B":n=2,r=1}for(var i=0;i<t.length;i++)i%4==n&&(0===e[i+r]&&t[i]%2==1||0!==e[i+r]&&t[i]%2==0)&&(255===t[i]?t[i]--:t[i]++);return t},e.Canvas=o},425:(t,e)=>{function o(t){if(!(this instanceof o))return new o(t)}o.prototype.create=function(t,e,o){for(var n,r,i=0;i<e.rows;i++){r=e.y+(e.pageHeight-e.allHeight)/2+(e.ySpace+e.boxHeight)*i;for(var a=0;a<e.cols;a++){n=e.x+(e.pageWidth-e.allWidth)/2+(e.xSpace+e.boxWidth)*a;var s=this.createItem(n,r,i,a,e,o);t.appendChild(s)}}},o.prototype.createItem=function(t,e,o,n,r,i){var a=document.createElement("div"),s=document.createTextNode(i.content);return a.appendChild(s),a.id=r.boxId+"_"+o+n,a.style.webkitTransform="rotate(-"+i.rotateAngle+"deg)",a.style.MozTransform="rotate(-"+i.rotateAngle+"deg)",a.style.msTransform="rotate(-"+i.rotateAngle+"deg)",a.style.OTransform="rotate(-"+i.rotateAngle+"deg)",a.style.transform="rotate(-"+i.rotateAngle+"deg)",a.style.visibility="",a.style.position=i.position,a.style.zIndex=i.zIndex,a.style.left=t+"px",a.style.top=e+"px",a.style.overflow="hidden",a.style.pointerEvents="none",a.style.opacity=i.fontAlpha,a.style.filter="alpha(opacity="+i.fontAlpha+"100)",a.style.fontSize=i.fontSize,a.style.fontFamily=i.fontFamily,a.style.lineHeight=i.fontSize,a.style.color=i.fontColor,a.style.textAlign=i.textAlign,a.style.width=r.boxWidth+"px",a.style.height=r.boxHeight+"px",a.style.display="block",a.style["-ms-user-select"]="none",a},e.ShadowRoot=o},15:(t,e)=>{function o(){if(!(this instanceof o))return new o;this.type=window.addEventListener?1:2}o.prototype.on=function(t,e,o,n){1===this.type?t.addEventListener(e,o,n):t.attachEvent("on"+e,o)},o.prototype.off=function(t,e,o,n){1===this.type?t.removeEventListener(e,o):t.detachEvent(e,o)},o.prototype.dispatch=function(t,e){return t.dispatchEvent(e)},e.EventListener=o},202:(t,e)=>{function o(t){if(!(this instanceof o))return new o(t);this.watermark=t,this.MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,this.watermarkDom,this.oldOpts={width:0,height:0},this.option={childList:!0,attributes:!0,subtree:!0,attributeFilter:["style"],attributeOldValue:!0}}o.prototype.init=function(){if(this.MutationObserver){var t=this.callback(this.watermark);this.watermarkDom=new this.MutationObserver(t)}},o.prototype.callback=function(t){return function(e){e.length>0&&t.render()}},o.prototype.onListener=function(t,e){if(e.monitor&&this.watermarkDom){var o=document.getElementById(t.boxId);o&&(this.watermarkDom.observe(o,this.option),o.shadowRoot&&this.watermarkDom.observe(o.shadowRoot,this.option))}},o.prototype.removeListener=function(){this.watermarkDom&&this.watermarkDom.disconnect()},e.MutationListener=o},648:(t,e)=>{function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function n(t){return"[object Undefined]"==Object.prototype.toString.call(t)}var r,i,a,s;e.isObject=function(t){return"[object Object]"==Object.prototype.toString.call(t)&&null!==t},e.isFun=function(t){return"[object Function]"==Object.prototype.toString.call(t)},e.isArray=function(t){return"[object Array]"==Object.prototype.toString.call(t)},e.isString=function(t){return"[object String]"==Object.prototype.toString.call(t)},e.isNumber=function(t){return"[object Number]"==Object.prototype.toString.call(t)},e.isDate=function(t){return t instanceof Date},e.getUUId=function(){var t=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var o=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?o:3&o|8).toString(16)}))},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length,o=Number(arguments[1])||0;for(o<0&&(o+=e);o<e;){if(o in this&&this[o]===t)return o;o++}return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var o=arguments[1],n=0;n<e;n++)n in this&&t.call(o,this[n],n,this)}),Array.prototype.map||(Array.prototype.map=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var o=new Array(e),n=arguments[1],r=0;r<e;r++)r in this&&(o[r]=t.call(n,this[r],r,this));return o}),Array.prototype.filter||(Array.prototype.filter=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var o=new Array,n=arguments[1],r=0;r<e;r++)r in this&&t.call(n,this[r],r,this)&&o.push(val);return o}),Array.prototype.some||(Array.prototype.some=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var o=arguments[1],n=0;n<e;n++)if(n in this&&t.call(o,this[n],n,this))return!0;return!1}),Array.prototype.every||(Array.prototype.every=function(t){var e=this.length;if("function"!=typeof t)throw new TypeError;for(var o=arguments[1],n=0;n<e;n++)if(n in this&&!t.call(o,this[n],n,this))return!1;return!0}),Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),s=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(t){if("object"!==o(t)&&"function"!=typeof t||null===t)throw new TypeError("Object.keys called on non-object");var e=[];for(var n in t)r.call(t,n)&&e.push(n);if(i)for(var l=0;l<s;l++)r.call(t,a[l])&&e.push(a[l]);return e})),Object.assign||(Object.assign=function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(o[i]=r[i])}return o}),e.assign=function(t,e){if("object"===o(e=e||{}))for(var r in e)n(e[r])||(t[r]=e[r]);return t},e.debounce=function(t,e,o){var n,r,i;function a(){return setTimeout((function(){o.immedi||(t.apply(r,i),r=i=null)}),e)}return o=o||{},function(){r=this;for(var e=arguments.length,s=new Array(e),l=0;l<e;l++)s[l]=arguments[l];i=s,clearTimeout(n),n=a(),o.immedi&&t.apply(r,i)}}},185:(t,e,o)=>{var n=o(202).MutationListener,r=o(305).Adapter,i=o(648).getUUId;function a(t){if(!(this instanceof a))return new a(t);this.mutationListener=new n(this),this.mutationListener.init(),this.status=!1,this.key=i()}a.prototype.init=function(t){this.opts=t||{},this.status=!1;var e={boxId:t.boxId+"_"+this.key,pageOffTop:0,pageOffLeft:0,x:0,y:0,pageWidth:null,pageHeight:null,cols:0,rows:0,allWidth:0,allHeight:0};e.x=t.x+e.pageOffLeft,e.y=t.y+e.pageOffTop;var o=e.containerBox=t.containerNode&&document.getElementById(t.containerNode)||document.body;return this._calaBoxSize(e,t),this._getPageWidthHeight(e,o),this._caleMarkCount(e,t),this._calcTotalLength(e,t,o),this._opts=e,console.log(e),this},a.prototype.render=function(){console.log("渲染 水印！");var t=this.opts,e=this._opts;this.clear(e),new r(e).render(t),this.mutationListener.onListener(e,t)},a.prototype._calaBoxSize=function(t,e){var o=document.createElement("span");o.style.visibility="hidden",o.style.fontSize=e.fontSize,o.style.lineHeight=e.fontSize,o.style.overflow="hidden",o.style.whiteSpace="nowrap",o.style.textOverflow="ellipsis",o.style.position="absolute",document.body.appendChild(o),void 0!==o.textContent?o.textContent=e.content:o.innerText=e.content,t.boxWidth=o.offsetWidth,t.boxHeight=o.offsetHeight,o.parentNode.removeChild(o)},a.prototype._getPageWidthHeight=function(t,e){t.pageWidth=Math.max(e.scrollWidth,e.clientWidth),t.pageHeight=Math.max(e.scrollHeight,e.clientHeight)},a.prototype._caleMarkCount=function(t,e){t.cols=parseInt((t.pageWidth-t.x)/(t.boxWidth+e.xSpace)),t.xSpace=parseInt((t.pageWidth-t.x-t.boxWidth*t.cols)/t.cols),t.rows=parseInt((t.pageHeight-t.y)/(t.boxHeight+e.ySpace)),t.ySpace=parseInt((t.pageHeight-t.y-t.boxHeight*t.rows)/t.rows)},a.prototype._calcTotalLength=function(t,e){t.allWidth=t.x+t.boxWidth*t.cols+t.xSpace*(t.cols-1),t.allHeight=t.y+t.boxHeight*t.rows+t.ySpace*(t.rows-1)},a.prototype.clear=function(t){var e,o=document.getElementById(t.boxId);null==o||null===(e=o.parentNode)||void 0===e||e.removeChild(o),this.mutationListener.removeListener()},a.prototype.remove=function(){this.clear(),this.mutationListener.removeListener()},e.WaterMark=a}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}var n={};return(()=>{var t=n;function e(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=o(185).WaterMark,i=o(648),a=i.debounce,s=i.assign,l=o(15).EventListener,c=o(938).defaultOpt,p=new l,h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=s({},c);this.opts=s(o,e||{});var n=this.watermark=new r;this._debounceFn=a((function(t){n.init(t).render()}),1e3)}var o,n;return o=t,(n=[{key:"init",value:function(){var t=this,e=this.opts;e.onLoad?p.on(window,"load",(function(){t._debounceFn(e)})):this.reload(e),e.onResize&&p.on(window,"resize",(function(){t._debounceFn(e)}))}},{key:"reload",value:function(t){var e;t&&(this.opts=e=t),this.watermark.init(e).render()}},{key:"remove",value:function(){this.opts.onLoad&&p.off(window,"load"),this.opts.onResize&&p.off(window,"resize"),this.watermark.status=!1,this.watermark.remove()}}])&&e(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),t}();t.WaterMark=h})(),n})()));